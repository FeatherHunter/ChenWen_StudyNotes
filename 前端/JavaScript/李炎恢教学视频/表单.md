1、表单的作用
> 1.早期，是为了分担服务器处理表单的压力，从而打破了处处依赖服务器的局面；

2、表单介绍
> 1.在HTML中，表单是由<form>元素表示的；
> 2.表单对应的类型是，HTMLFormElement类型；

3、表单特有的属性和方法
|属性|说明|
|---|---|
|acceptCharset|服务器能够处理的字符集|
|action|接受请求的URL|
|elements|表单中所有控件的集合|
|enctype|请求的编码类型|
|length|表单中控件的数量|
|name|表单的名称|
|target|用于发送请求和接受响应的窗口名称|
|reset()|将所有表单重置|
|submit()|提交表单|

4、获取表单<form>对象的方法
> 1.通过ID获取；
> 2.通过元素标签名获取；
> 3.通过forms集合获取，用下标获取，语法：`document。forms[index]`；
> 4.通过forms集合获取，用name值获取，语法：`document.forms[name]`；
> 5.使用name值，直接获取（不推荐，会不兼容，因为name值可以相同）；
```
<form id="myForm" name="yourForm"></form>

var form = document.getElementById('myForm');          
var form = document.getElementsByTagName('form')[0];
var form = document.forms[0];
var form = document.forms['yourForm'];
var form = document.yourForm;
```

5、提交表单
> 1.submit事件的默认行为是：携带数据跳转到指定页面；
> 2.通过form事件对象，可以阻止submit的默认行为；
> 1. 无法通过input中的提交按钮触发该事件；
> 2. 但是触发submit事件的流程是input中的提交按钮；
> **解释：只有form有submit事件，按钮只有点击事件；**
```
addEvent(window,'load',function(){
    var form = document.getElementById('myForm');
    addEvent(form,'submit',function(evt){
        evt.preventDefault();
    })
});
```
> 3.也可以使用submit()方法来自定义触发submit事件，也就是说不一定非得点击提交按钮，才会提交数据(可以是普通按钮等非提交按钮)；
> **注意：当form表单中有提交按钮的`name="submit"和id="submit"`属性时，浏览器无法识别`form.submit();`方法，解决办法是去掉改属性或者删除这个提交按钮；**
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user"/>
    <input id="button" type="button" value="普通按钮"/>
    <input type="submit" name="submit" value="提交"/>     <!--这里有name属性，所以无法识别submit()方法-->
</form>

addEvent(window, 'load', function () {
    var form = document.getElementById('myForm');     //获取表单
    var button = document.getElementById('button');   //获取普通按钮
    addEvent(button, 'click', function () {
        form.submit();                                //提交按钮的name属性，会导致这里无法识别
    });
});
```
> 4.使用ctrl+enter实现提交表单
```
addEvent(window, 'load', function () {
    var form = document.getElementById('myForm');     //获取表单
    addEvent(document, 'keydown', function (evt) {
        if (evt.ctrlKey && evt.keyCode === 13) {      //表示ctrl+enter键
            form.submit();
        }
    });
});
```

6、提交表单存在的问题——重复提交
> 1.当一条数据提交到服务器的时候会出现延迟等长时间没反应；
> 2.会导致用户不停的点击提交按钮，从而使得重复提交了很多相同的请求，或造成错误、或写入数据库多条相同的信息。
> 3.解决方法：
> 1. 将提交按钮禁用，只限于按钮；
```
addEvent(form, 'submit', function (evt) {
    evt.preventDefault();
    //模拟延时
    var submit = document.getElementById('sub');
    submit.disabled = true;        //第一次提交后，将按钮禁用
    setTimeout(function () {
        form.submit()
    }, 5000);
});
```
> 2. 提交之后取消后续的表单提交操作；
```

addEvent(window, 'load', function () {
    var form = document.getElementById('myForm');
    var flag = false;
    //阻止提交按钮的默认行为
    addEvent(form, 'submit', function (evt) {
        evt.preventDefault();
        if(flag)return;
        flag = true;               //提交一次之后，设置为true
        setTimeout(function () {
            form.submit();
        }, 5000);
    });
});
```

7、重置表单
> 1.当用户点击重置按钮时，表单会被初始化。目前很少使用，因为点了重置之后，用户填写的信息会清空。
> 2.两种方法重置表单：
> 1. 设置`type="reset"`;
```html
<input type="reset" value="重置"/>
```
> 2. 使用`form.reset()`方法；
```
addEvent(document,'click',function(){
    form.reset();
});
```
```
//form表单的reset事件
addEvent(form,'reset',function(){
    alert('reset');
});
```

8、表单字段——表单下的控件(input)
> 1.如果想要访问表单元素，可以使用DOM的方式访问，但是不是很便利。
> 2.可以使用HTML DOM来访问。
> 3.它有elements属性，该属性是表单中所有元素的集合。
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user"/>
    <input id="sub" type="submit" value="提交"/>
    <input type="reset" value="重置"/>
</form>

var form = document.getElementById('myForm');
console.log(form.elements);          //表单控件集合HTMLFormControlsCollection
console.log(form.elements[0]);       //获取表单里的第一个控件
console.log(form.elements['user']);  //获取表单里的第一个控件，用name值获取
console.log(form.elements.length);   //获取表单长度，3
```
> 4.如果一个name值对应多个表单字段，则会返回该name的NodeList表单列表；
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user"/>
    <input type="radio" name="sex" value="男"/>男
    <input type="radio" name="sex" value="女"/>女
    <input id="sub" type="submit" value="提交"/>
    <input type="reset" value="重置"/>
</form>

var form = document.getElementById('myForm');
console.log(form.elements['sex']);         //RadioNodeList
```

9、共有的表单字段属性
|属性或方法|说明|
|---|---|
|disabled|布尔值，表示当前字段是否被禁用|
|form|指向当前字段所属表单的指针，只读|
|name|当前字段的名称|
|readOnly|布尔值，表示当前字段是否只读|
|tabIndex|表示当前字段的切换|
|type|当前字段的类型|
|value|当前字段值|
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user" value="请输入用户名"/>
</form>
console.log(form.elements[0].value);      //请输入用户名
console.log(form.elements[0].type);       //text
console.log(form.elements[0].name);       //user
form.elements[0].disabled=true;           //禁用第一个表单字段
console.log(form.elements[0].form);       //获取整个form表单
```

10、表单字段的type属性
|元素说明|HTML标签|type属性值|
|---|---|---|
|单选列表|<select>|select-one|
|多选列表|<select multiple>|select-multiple|
|自定义按钮|<button>|button|
|自定义非提交按钮|<button type="button">|button|
|自定义重置按钮|<button type="reset">|reset|
|自定义提交按钮|<button type="submit">|submit|
```
<form id="myForm" name="yourForm">
    <select name="sel">
        <option>红烧猪蹄</option>
        <option>油蒙茄子</option>
    </select>
</form>
    console.log(form.elements['sel'].type);     //select-one
```

11、表单字段的共有方法
|方法|说明|
|---|---|
|focus()|将焦点定位到表单字段里|
|blur()|从元素中将焦点移走|
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user" value="请输入用户名"/>
</form>
form.elements['user'].focus();
form.elements['user'].blur();
```

12、表单字段共有事件
|事件名|说明|
|---|---|
|onblur|当字段失去焦点时触发|
|onchange|对于<input>和<textarea>元素，在改变value并失去焦点时触发；对于<select>元素，在改变选项时触发|
|onfocus|当前字段获取焦点时触发|
```
addEvent(user, 'focus', function () {
    console.log('触发focus事件');
});
addEvent(user, 'blur', function () {
    console.log('触发blur事件');
});
addEvent(user, 'change', function () {
    console.log('触发input的change事件');
});
```

13、文本框的类型
> 1.单行文本框
```
<input type="text"/>
```
> 2.多行文本框
```
<textarea>
```
> 3.defaultValue属性：获取默认值；
```
alert(textarea.defaultValue);
```
> 4.区别：单行文本框，在字面上有value属性；而多行文本框则没有。但是都可以通过value来获取值；
> 1. 使用HTML DOM可以获取这两个文本框的vale值；
> 2. 使用标准DOM获取多行文本框时，会出错，因为它在HTML层面没有value属性；
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user" value="请输入用户名">
    <br/>
    <textarea name="text">11111111111111</textarea>
</form>

    var user = form.elements['user'];
    var textarea = form.elements['text'];
    console.log(user.value);                      //请输入用户名，HTML DOm获取
    console.log(user.getAttribute('value'));      //请输入用户名，标准DOM获取
    console.log(textarea.value);                  //11111111111111，HTML DOm获取
    console.log(textarea.getAttribute('value'));  //null，标准DOM获取
```

14、选择文本框中的内容，并移入焦点
> 1.使用select()方法，可以将文本框里的所有文本选中，并且将焦点设置到文本框中。
```
var user = form.elements['user'];
user.select();     //会选中文本框中的内容，并且焦点也在该文本框中
```

15、选择文本框中的部分内容(无标准)
> 1.IE9及以上版本和Chrome浏览器：setSelectionRange()方法，无焦点
> 1. 接受两个参数，起始位置和结束位置；
```
var user = form.elements['user'];
user.setSelectionRange(0,2);                    //第0个到第2个位置
//user.setSelectionRange(0,user.value.length);  //获取文本框中的所有内容
user.focus();                                   //获取焦点，然后可以直接输入新内容
```
> 2.IE8及以下版本：IE文本范围(IE所有版本兼容)，有焦点
> 1. 从起始位置选择n个字符；
```
//从第0个位置选择1个字符
var range = user.createTextRange();    //创建一个本文范围对象
range.collapse(true);                  //将指针移到起点
range.moveStart('character',0);        //移动起点，character表示逐字移动
range.moveEnd('character',1);          //移动终点
//range.moveEnd('character',user.value.length);          //选定全部内容
range.select();    
```

16、select事件
> 1.选中文本后触发；
> 1. 在IE8及以下版本中，只要获取焦点，就会触发该事件；
> 2. 其他浏览器和IE高版本，选定文本且释放鼠标后，触发该事件；
> **注意：这里的this代表的是user对象，但是在IE8以下，创建事件采用的是attach()方法，该方法无法获取user对象，所以，这里的this在IE8以下不能使用**
```
function addEvent(obj, type, fn) {
    if (obj.addEventListener) {
        obj.addEventListener(type, fn, false);
    } else if (obj.attachEvent) {
        obj.attachEvent('on' + type, function () {
            fn.call(obj);                               //将this传递过来
        });
    }
}

addEvent(user,'select',function(){
    alert(this.value);                 //在IE8中无法显示,this不能表示user对象
});
```

17、取得选择的文本
> 1.其他浏览器和IE9以上：支持selectionStart和selectionEnd属性；
```
addEvent(user, 'select', function () {
    // alert('select');
    console.log(this.value);
    console.log("开始" + this.selectionStart);       //获取起始位置
    console.log("结束" + this.selectionEnd);         //获取终止位置
    console.log(this.value.substring(this.selectionStart,this.selectionEnd));
});                                                 //打印出选中的文本
```
> 2.IE8及以下的版本中：selection对象，属于document。这个对象保存着用户在整个文档范围内选择的文本信息；
> 1. document.selection有一个方法可以创建文本范围对象：createRange();
> 2. 这个文本范围对象有一个属性可以得到你选择的文本：text
> 3. 不能用alert打印结果
```
<form id="myForm" name="yourForm">
    姓名：<input type="text" name="user" value="请输入用户名" />
</form>

var user = form.elements['user'];
addEvent(user, 'select', function () {
     console.log(document.selection.createRange().text);
});
```

18、文本过滤输入
> 1.为了使文本框输入指定的字符，必须对输入的字符进行验证。
> 2.一种做法是提交后判断，另一种是提交之前限制某些字符；
> 3.文本过滤模式：纯数字
> 1. 禁止或屏蔽非数字键的输入，阻止非数字键的默认行为；
> 2. 验证后取消，可以先输入非法字符，然后判断，取消刚输入的文本；




|属性|说明|
|---|---|
|clientX|ww|
|clientX|ww|
|clientX|ww|
|clientX|ww|
|clientX|ww|
|clientX|ww|
|clientX|ww|
